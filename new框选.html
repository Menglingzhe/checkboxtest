<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    https://www.jianshu.com/p/5052c6fd2502//参考
    <div
      class="box"
      id="divBox"
      style="margin: 0 auto; height: 400px; padding: 100px 10px"
    >
      <div class="che" style="display: flex; justify-content: center">
        <input
          type="checkbox"
          name="che1"
          id="c1"
          value="第1项"
          onclick="Get(this)"
        />
        <input
          type="checkbox"
          name="che1"
          id="c2"
          value="第2项"
          onclick="Get(this)"
        />
        <input
          type="checkbox"
          name="che1"
          id="c3"
          value="第3项"
          onclick="Get(this)"
        />
        <input
          type="checkbox"
          name="che1"
          id="c4"
          value="第1项"
          onclick="Get(this)"
        />
        <input
          type="checkbox"
          name="che1"
          id="c5"
          value="第2项"
          onclick="Get(this)"
        />
        <input
          type="checkbox"
          name="che1"
          id="c6"
          value="第3项"
          onclick="Get(this)"
          style="overflow: visible; word-break: break-all"
        />
      </div>

      <div class="che" style="display: flex; justify-content: center">
        <input
          type="checkbox"
          name="che1"
          id="c7"
          value="第1项"
          onclick="Get(this)"
        />
        <input
          type="checkbox"
          name="che1"
          id="c8"
          value="第2项"
          onclick="Get(this)"
        />
        <input
          type="checkbox"
          name="che1"
          id="c9"
          value="第3项"
          onclick="Get(this)"
        />
        <input
          type="checkbox"
          name="che1"
          id="c10"
          value="第1项"
          onclick="Get(this)"
        />
        <input
          type="checkbox"
          name="che1"
          id="c11"
          value="第2项"
          onclick="Get(this)"
        />
        <input
          type="checkbox"
          name="che1"
          id="c12"
          value="第3项"
          onclick="Get(this)"
        />
      </div>
    </div>

    <script>
      //https://www.jianshu.com/p/5052c6fd2502//参考
      (function () {
        // 定时器id
        var mouseStopId;
        // 是否开启框选功能
        var mouseOn = false;
        // 用来存放鼠标点击初始位置
        var startX = 0;
        var startY = 0;

        document
          .getElementById("divBox") // 添加鼠标按下监听事件
          .addEventListener("mousedown", function (e) {
            console.log("按下");
            clearEventBubble(e); // 阻止事件冒泡
            // 判断是否为鼠标左键被按下
            if (e.buttons !== 1 || e.which !== 1) return;

            mouseStopId = setTimeout(function () {
              mouseOn = true;
              startX = e.clientX;
              startY = e.clientY;
              console.log(startX, startY, "起始");
              var selDiv = document.createElement("div"); //创建框子
              // 给框选元素添加css样式，这里使用绝对定位
              selDiv.style.cssText =
                "position:absolute;width:0;height:0;margin:0;padding:0;border:1px dashed #eee;background-color:#aaa;z-index:1000;opacity:0.6;display:none;";
              // 添加id
              selDiv.id = "selectDiv";
              document.body.appendChild(selDiv);
              // 根据起始位置，添加定位
              selDiv.style.left = startX + "px";
              selDiv.style.top = startY + "px";
            }, 300); // 间隔300毫秒后执行，判定这时候鼠标左键被按住不放
          });

        document
          .getElementById("divBox") // 添加鼠标移动事件监听
          .addEventListener("mousemove", function (e) {
            console.log("移动");
            // 如果并非框选开启，退出
            if (!mouseOn) return;
            // 阻止事件冒泡
            clearEventBubble(e);
            // 处理鼠标移动
            var _x = e.clientX;
            var _y = e.clientY;
            // 根据坐标给选框修改样式
            var selDiv = document.getElementById("selectDiv");
            selDiv.style.display = "block";
            selDiv.style.left = Math.min(_x, startX) + "px";
            selDiv.style.top = Math.min(_y, startY) + "px";
            selDiv.style.width = Math.abs(_x - startX) + "px";
            selDiv.style.height = Math.abs(_y - startY) + "px";
          }); //

        // document
        //   .getElementById("divBox") // 添加鼠标点击松开事件监听
        document.body
          .addEventListener('mouseup', function (e) {
            // 阻止事件冒泡
            console.log("松开");
            clearEventBubble(e);
            // 处理鼠标点击松开
            let fileDivs = document.getElementsByName("che1"); //被点击点
            // console.log(fileDivs,'@')
            var selDiv = document.getElementById("selectDiv");
            // var fileDivs = document.getElementsByTagName('')
            var selectedEls = [];
            // 获取参数
            var l = selDiv.offsetLeft;
            var t = selDiv.offsetTop;
            var w = selDiv.offsetWidth;
            var h = selDiv.offsetHeight;
            for (var i = 0; i < fileDivs.length; i++) {
              var sl = fileDivs[i].offsetWidth + fileDivs[i].offsetLeft;
              var st = fileDivs[i].offsetHeight + fileDivs[i].offsetTop;

              if (
                sl > l &&
                st > t &&
                fileDivs[i].offsetLeft < l + w &&
                fileDivs[i].offsetTop < t + h
              ) {
                // 该DOM元素被选中，进行处理
                selectedEls.push(fileDivs[i]);
              }
            }
            // 打印被选中DOM元素
            // console.log(selectedEls);
            for(let i of selectedEls){
                i.checked =  true ;
            }
            // 恢复参数
            selDiv.style.display = "none";
            mouseOn = false;
          });




        function clearEventBubble(e) {
          if (e.stopPropagation) e.stopPropagation();
          else e.cancelBubble = true;

          if (e.preventDefault) e.preventDefault();
          else e.returnValue = false;
        }
      })();
    </script>
  </body>
</html>
